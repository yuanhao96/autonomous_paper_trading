# Runtime configuration for the trading system
llm:
  model: "claude-sonnet-4-5"
  max_retries: 3
  retry_base_delay: 1.0  # seconds, exponential backoff

schedule:
  market_open_scan: "30 9 * * 1-5"
  daily_evaluation: "0 17 * * 1-5"
  daily_report: "30 17 * * 1-5"
  nightly_learning: "0 22 * * *"
  weekly_evolution_review: "0 10 * * 6"

data:
  cache_dir: "data/market"
  knowledge_dir: "knowledge/memory"
  default_period: "1y"
  default_interval: "1d"
  # Path to the directory containing plain-text book files.
  # Override with BOOKS_DIR environment variable.
  books_dir: "~/projects/investment-books-text"
  books_config: "config/books.yaml"
  # Maximum number of chunks to load per book per learning session.
  book_max_chunks: 3
  # Characters per chunk when splitting book content.
  book_chunk_size: 3000
  # Characters to skip at start of each book (front matter / copyright).
  book_skip_chars: 3000
  # Web search settings for nightly learning.
  web_search_max_results: 5
  web_search_fetch_articles: 2

database:
  trades_db: "data/paper_trades.db"
  agent_state_db: "data/agent_state.db"

logging:
  llm_log_file: "logs/llm_calls.jsonl"
  trade_log_file: "logs/trades.jsonl"
  level: "INFO"

# Multi-round learning controller configuration
learning:
  max_rounds: 3
  confidence_threshold: 0.75
  min_marginal_gain: 0.05
  per_topic_budget: 50000  # approximate token budget per topic
  tool_policies:
    stage_1: [memory, web, wikipedia, books]
    stage_2: [memory, web, wikipedia, books, arxiv]
    stage_3: [memory, web, books, arxiv]
    stage_4: [memory, web, arxiv, news]

# V2: Evolution cycle configuration
evolution:
  batch_size: 10
  survivor_count: 3
  max_cycles_per_day: 1
  min_sharpe_floor: -0.5
  backtest_ticker: "SPY"
  periods:
    - {name: "GFC", start: "2007-01-01", end: "2009-06-30", weight: 1.0}
    - {name: "Low-vol grind", start: "2013-01-01", end: "2014-12-31", weight: 1.0}
    - {name: "Melt-up + vol spike", start: "2017-01-01", end: "2018-03-31", weight: 1.0}
    - {name: "COVID cycle", start: "2019-06-01", end: "2021-06-30", weight: 1.5}
    - {name: "Rate hiking bear", start: "2022-01-01", end: "2022-12-31", weight: 1.5}
    - {name: "Current", start: "2024-01-01", end: "2025-02-28", weight: 2.0}
  exhaustion_detection:
    plateau_cycles: 5
    min_score_improvement: 0.01
